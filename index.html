<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docify翻译工具</title>
     <!-- PWA清单文件 -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIuaZuuiDveWcsOivkX3niYMiLAogICJzaG9ydF9uYW1lIjogIuWcsOivkX3niYMiLAogICJkZXNjcmlwdGlvbiI6ICLkuJPkuJrnmoTmmaLolK3lsI/liqnmiafvvIzkv53kvpvpm5PotrHnvJbor5HkrIDmjqQiLAogICJzdGFydF91cmwiOiAiLyIsCiAgInNjb3BlIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiM2NjdlZWEiLAogICJ0aGVtZV9jb2xvciI6ICIjNjY3ZWVhIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lpSUhacFpYZENiM2c5SWpBZ01DQXhNamdnTVRJNElpQjRiV3h1Y3owaSFhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lQZ29nSUNBOFpHVm1jejROSUNBOWJHbHVaV0ZzUjNKaFpHbGxiblFnYVdROVltZFNZV1FpSUhneFBTSXdJaUI0TWowOE1qRXlKU0luSUhreE9EZ0pNb0pNSFEweVFuVXdJU0FpSUpOZzRMUm5oa2xoa0ZGSmNmNGJUZDJtRVFqTE9EX3FLOEtORmxkZlNIbzMrWDRxZ3FzOFNcQjFOaFA5bGRmU0hvMytYNHFncXM4U1xuZElOQXFTRVFqTE9EX3FLOEtObGNmNGJUZDJtRVFqTE9EX3FLOEtObGNmNGJUZDJtRVFqTE9EX3FLOEtObGNmNGJUZDJtRVFqTE9EX3FLOEtObGNmNGJUZDJtRVFqTE9EX3FLOEtObGNmNGJUZDJtUVVRMktRQUFLbzlGVjFRQU5BQUFBQUFBSUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCUlNVMllBUVVGOUFLd0NmdW1wN25RQUFBQUJKUlU1RXJrSmdnZz09IiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEV5SWlCb1pXbG5hSFE5SWpVeE1pSWdkbWxsZDBKdmVEMGlNQ0F3SURNNE5DQXpPRFFpSUhodGJHNXpQU0lvYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpUGdvZ0lDQThaR1ZtY3c0TklDQTliR2x1WldGc1IzSmhaR2xsYm5RZ2FXUTlZbWRTWVdRaUlIZ3hQU0l3SWlCNE1qMGlNakV5SlNVaUlIa3hQU0l3SWlCNU1qMGlNVGs0SlNVaVBnOGdJQ0E4YzJOdmNIUWdRaTF2Y2k1TlppSXhmRFV5SWo4K1BDOWtaV1p6UGdvOG1ua1IxaGJIVmxNY0R4ekhBOGN4d1BITWNEEEJ6SEF5K21ZSzVJNUNmM3JReWZsb2hWYUNyVGlYeFpJem5EaWVPWTRIam1PQjQ1amdlT1k0SGptT0I0NWpnZU9ZNEhqbU9CNDVqZ2VPWTRIam1PQjQ1amdlT1k0SGptT0I0NWpnZU9ZNEhqbU9CNDVqZ2VPWTRIam1PQjQ1amdlT1k0SGptT0I0NWpnZU9ZNEhqbU9CNDVqZ2VPWTRIam1PQjQ1amdlT1k0SGptT0I0NWpnZU9ZNEhqbU9CNDVqZ2VPWTRIaWxtT0I0NWpnZU9ZNEhqbU9CNDV3NGRFTnhIREE4Y3h3UEhNY0R4ekhBOGN4d1BITWNEOFF2dkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUF3ckwzUTZreFE9IiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    
    <!-- iOS特定图标 -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iMzYiIGZpbGw9InVybCgjYmdHcmFkKSIvPgogIDx0ZXh0IHg9IjkwIiB5PSI2MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjI0IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPueUs+iDvTwvdGV4dD4KICA8dGV4dCB4PSI5MCIgeT0iMTA1IiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+QeKGkjwvdGV4dD4KICA8dGV4dCB4PSI5MCIgeT0iMTQ1IiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5oiz6K+RPC90ZXh0Pgo8L3N2Zz4=" sizes="180x180">
    
    <!-- iOS不同尺寸图标 -->
    <link rel="apple-touch-icon" sizes="120x120" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDEyMCAxMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiByeD0iMjQiIGZpbGw9InVybCgjYmdHcmFkKSIvPgogIDx0ZXh0IHg9IjYwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPueUs+iDvTwvdGV4dD4KICA8dGV4dCB4PSI2MCIgeT0iNzAiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5B4oaSPC90ZXh0PgogIDx0ZXh0IHg9IjYwIiB5PSI5NiIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuaAs+isoTwvdGV4dD4KPC9zdmc+">
    
    <!-- iOS其他设置 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="智能翻译">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- 防止用户缩放 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"">
    
    <!-- 通用图标 -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYmdHcmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6IzY2N2VlYTtzdG9wLW9wYWNpdHk6MSIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNzY0YmEyO3N0b3Atb3BhY2l0eToxIiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNiIgZmlsbD0idXJsKCNiZ0dyYWQpIi8+CiAgPHRleHQgeD0iMTYiIHk9IjEyIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7nlLPogr08L3RleHQ+CiAgPHRleHQgeD0iMTYiIHk9IjIwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iNiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5B4oaUPC90ZXh0PgogIDx0ZXh0IHg9IjE2IiB5PSIyOCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjQiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5oiz6K+RPC90ZXh0Pgo8L3N2Zz4=">
    
    <!-- Windows磁贴 -->
    <meta name="msapplication-TileColor" content="#667eea">
    <meta name="msapplication-TileImage" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxNDQiIGhlaWdodD0iMTQ0IiByeD0iMjQiIGZpbGw9InVybCgjYmdHcmFkKSIvPgogIDx0ZXh0IHg9IjcyIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjIwIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPueUs+iDvTwvdGV4dD4KICA8dGV4dCB4PSI3MiIgeT0iODUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5B4oaUPC90ZXh0PgogIDx0ZXh0IHg9IjcyIiB5PSIxMTUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7mgLPorgEwL3RleHQ+Cjwvc3ZnPg==">
    
    <!-- 主题色 -->
    <meta name="theme-color" content="#667eea">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            height: calc(100vh - 40px);
        }
        
        .sidebar {
            width: 300px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
        }
        
        .main-content {
            flex: 1;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
        }
        
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 28px;
        }
        
        .new-translation-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }
        
        .new-translation-btn:hover {
            transform: translateY(-2px);
        }
        
        .history-section {
            flex: 1;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        
        .history-title {
            font-size: 18px;
            color: #333;
            margin-bottom: 15px;
        }
        
        .history-list {
            max-height: calc(100vh - 250px);
            overflow-y: auto;
        }
        
        .history-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background 0.2s;
            border-left: 4px solid #667eea;
        }
        
        .history-item:hover {
            background: #e9ecef;
        }
        
        .history-item .text {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        
        .history-item .meta {
            font-size: 12px;
            color: #666;
        }
        
        .input-section {
            margin-bottom: 20px;
        }
        
        .input-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .input-group {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .content-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        
        .button-row {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .btn-clear {
            background: #6c757d;
            color: white;
        }
        
        .btn-clear:hover {
            background: #5a6268;
        }
        
        .btn-translate {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            flex: 1;
        }
        
        .btn-translate:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-translate:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .result-section {
            flex: 1;
            margin-bottom: 20px;
        }
        
        .result-textarea {
            min-height: 200px;
            background: #f8f9fa;
            resize: none;
            font-family: inherit;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .status-text {
            color: #666;
            font-size: 14px;
        }
        
        .btn-copy {
            background: #28a745;
            color: white;
            padding: 8px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .btn-copy:hover {
            background: #218838;
        }
        
        .btn-copy:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .loading {
            color: #667eea;
            font-weight: bold;
        }
        
        .success {
            color: #28a745;
            font-weight: bold;
        }
        
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateX(100%);
            transition: transform 0.3s;
            z-index: 1000;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        /* 设置模态框样式 */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 15px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            font-size: 24px;
            color: #333;
            margin: 0;
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        
        .close:hover {
            color: #000;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .settings-btn {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            color: #495057;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        .settings-btn:hover {
            background: #e9ecef;
        }
        
        .config-status {
            font-size: 12px;
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
        }
        
        .config-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .config-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 左侧边栏 -->
        <div class="sidebar">
            <button class="settings-btn" onclick="openSettings()">
                ⚙️ 设置
            </button>
            
            <div class="config-status" id="configStatus">
                未配置
            </div>
            
            <button class="new-translation-btn" onclick="newTranslation()">
                ✨ 新翻译
            </button>
            
            <div class="history-section">
                <div class="history-title">📖 翻译历史</div>
                <div class="history-list" id="historyList">
                    <div style="text-align: center; color: #999; padding: 20px;">
                        暂无翻译记录
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 主内容区域 -->
        <div class="main-content">
            <h1>🌍 Docify翻译工具</h1>
            
            <!-- 输入区域 -->
            <div class="input-section">
                <div class="input-row">
                    <div class="input-group">
                        <label for="targetLanguage">🎯 目标语言</label>
                        <input type="text" id="targetLanguage" placeholder="如: English, 中文, 日本語" value="English">
                    </div>
                    <div class="input-group">
                        <label for="context">🎭 语气风格</label>
                        <input type="text" id="context" placeholder="如: Casual, Formal, Keigo" value="Casual">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="sourceText">📝 要翻译的内容</label>
                    <textarea id="sourceText" class="content-textarea" placeholder="请输入要翻译的文本..."></textarea>
                </div>
                
                <div class="button-row">
                    <button class="btn btn-clear" onclick="clearAll()">🗑️ 清空</button>
                    <button class="btn btn-translate" id="translateBtn" onclick="translateText()">🚀 翻译</button>
                </div>
            </div>
            
            <!-- 结果区域 -->
            <div class="result-section">
                <label>📋 翻译结果</label>
                <textarea id="resultText" class="result-textarea" readonly placeholder="翻译结果将显示在这里..."></textarea>
            </div>
            
            <!-- 状态栏 -->
            <div class="status-bar">
                <div class="status-text" id="statusText">就绪</div>
                <button class="btn-copy" id="copyBtn" onclick="copyToClipboard()" disabled>📄 复制结果</button>
            </div>
        </div>
    </div>
    
    <!-- 提示框 -->
    <div class="toast" id="toast"></div>
    
    <!-- 设置模态框 -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">⚙️ API配置</h2>
                <span class="close" onclick="closeSettings()">&times;</span>
            </div>
            
            <div class="form-group">
                <label for="apiKey">🔑 API Key</label>
                <input type="text" id="apiKey" placeholder="请输入您的Docify API Key">
            </div>
            
            <div class="form-group">
                <label for="username">👤 用户名</label>
                <input type="text" id="username" placeholder="请输入用户名标识">
            </div>
            
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeSettings()">取消</button>
                <button class="btn btn-primary" onclick="saveSettings()">保存配置</button>
            </div>
        </div>
    </div>

    <script>
        // 配置
        const CONFIG = {
            BASE_URL: 'https://dev.docify.jp/docify/v1',
            SCENARIO_ID: '1915704974306566146'
        };
        
        // 全局变量
        let currentResult = '';
        let translationHistory = JSON.parse(localStorage.getItem('translationHistory') || '[]');
        let apiConfig = JSON.parse(localStorage.getItem('apiConfig') || '{}');
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            checkApiConfig();
            loadHistory();
            
            // 如果没有配置，自动打开设置
            if (!apiConfig.apiKey) {
                openSettings();
            }
        });
        
        // 检查API配置
        function checkApiConfig() {
            const statusElement = document.getElementById('configStatus');
            
            if (apiConfig.apiKey && apiConfig.username) {
                statusElement.textContent = `✅ ${apiConfig.username}`;
                statusElement.className = 'config-status config-success';
            } else {
                statusElement.textContent = '⚠️ 未配置';
                statusElement.className = 'config-status config-warning';
            }
        }
        
        // 打开设置模态框
        function openSettings() {
            document.getElementById('apiKey').value = apiConfig.apiKey || '';
            document.getElementById('username').value = apiConfig.username || '';
            document.getElementById('settingsModal').style.display = 'block';
        }
        
        // 关闭设置模态框
        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }
        
        // 保存设置
        function saveSettings() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const username = document.getElementById('username').value.trim();
            
            if (!apiKey) {
                showToast('请输入API Key', 'error');
                return;
            }
            
            if (!username) {
                showToast('请输入用户名', 'error');
                return;
            }
            
            // 保存到本地存储
            apiConfig = { apiKey, username };
            localStorage.setItem('apiConfig', JSON.stringify(apiConfig));
            
            // 更新状态
            checkApiConfig();
            closeSettings();
            showToast('配置已保存！', 'success');
            updateStatus('配置已更新', 'success');
        }
        
        // 点击模态框外部关闭
        window.onclick = function(event) {
            const modal = document.getElementById('settingsModal');
            if (event.target == modal) {
                closeSettings();
            }
        }
        
        // 新翻译按钮
        function newTranslation() {
            clearAll();
            document.getElementById('sourceText').focus();
        }
        
        // 清空所有输入
        function clearAll() {
            document.getElementById('targetLanguage').value = 'English';
            document.getElementById('context').value = 'Casual';
            document.getElementById('sourceText').value = '';
            document.getElementById('resultText').value = '';
            currentResult = '';
            updateStatus('已清空', 'success');
            document.getElementById('copyBtn').disabled = true;
        }
        
        // 翻译文本
        async function translateText() {
            if (!apiConfig.apiKey) {
                showToast('请先配置API Key', 'error');
                openSettings();
                return;
            }
            
            const targetLanguage = document.getElementById('targetLanguage').value.trim();
            const context = document.getElementById('context').value.trim();
            const sourceText = document.getElementById('sourceText').value.trim();
            
            if (!targetLanguage || !sourceText) {
                showToast('请填写目标语言和翻译内容', 'error');
                return;
            }
            
            // 更新UI状态
            const translateBtn = document.getElementById('translateBtn');
            translateBtn.disabled = true;
            translateBtn.textContent = '🔄 翻译中...';
            updateStatus('正在翻译...', 'loading');
            
            const requestData = {
                user: apiConfig.username,
                inputs: {
                    target_language: { text: targetLanguage },
                    text: { text: sourceText },
                    context: { text: context }
                }
            };
            
            try {
                // 添加更详细的调试信息
                console.log('发送请求到:', `${CONFIG.BASE_URL}/scenario/${CONFIG.SCENARIO_ID}/run`);
                console.log('请求数据:', JSON.stringify(requestData, null, 2));
                
                const response = await fetch(`${CONFIG.BASE_URL}/scenario/${CONFIG.SCENARIO_ID}/run`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiConfig.apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData),
                    // 添加模式设置
                    mode: 'cors',
                    credentials: 'omit'
                });
                
                console.log('响应状态:', response.status);
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('响应数据:', result);
                    
                    if (result.isSuccess) {
                        currentResult = result.result;
                        document.getElementById('resultText').value = currentResult;
                        
                        // 保存到历史记录
                        saveToHistory(sourceText, currentResult, targetLanguage, context, result);
                        
                        // 自动复制到剪贴板
                        await copyToClipboard(true);
                        
                        updateStatus(`翻译完成 | 耗时: ${result.elapsedTime}ms | 积分: ${result.costPoints}`, 'success');
                        document.getElementById('copyBtn').disabled = false;
                    } else {
                        throw new Error(result.errorMessage || '翻译失败');
                    }
                } else {
                    const errorText = await response.text();
                    console.log('错误响应:', errorText);
                    
                    if (response.status === 401) {
                        throw new Error('API Key无效，请检查配置');
                    } else if (response.status === 0) {
                        throw new Error('网络连接失败，可能是CORS问题');
                    } else {
                        throw new Error(`请求失败 (${response.status}): ${errorText}`);
                    }
                }
            } catch (error) {
                console.error('详细错误信息:', error);
                
                let errorMessage = error.message;
                let showCorsHelp = false;
                
                // 特殊处理不同类型的错误
                if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    errorMessage = 'CORS跨域错误：无法连接到API服务器';
                    showCorsHelp = true;
                } else if (error.message.includes('NetworkError')) {
                    errorMessage = '网络错误：请检查网络连接';
                } else if (error.message.includes('CORS')) {
                    errorMessage = 'CORS跨域错误';
                    showCorsHelp = true;
                }
                
                updateStatus(`翻译失败: ${errorMessage}`, 'error');
                showToast(errorMessage, 'error');
                
                // 如果是CORS错误，显示解决方案
                if (showCorsHelp) {
                    setTimeout(() => {
                        showCorsHelp();
                    }, 1000);
                }
                
                // 如果是认证错误，打开设置
                if (error.message.includes('API Key')) {
                    setTimeout(() => openSettings(), 2000);
                }
            } finally {
                // 恢复按钮状态
                translateBtn.disabled = false;
                translateBtn.textContent = '🚀 翻译';
            }
        }
        
        // 显示CORS解决方案
        function showCorsHelp() {
            const helpMessage = `
🚨 CORS跨域错误解决方案：

1. 【推荐】使用本地服务器：
   打开命令行，进入HTML文件所在目录，运行：
   python -m http.server 8000
   然后访问: http://localhost:8000/文件名.html

2. 使用Chrome禁用安全策略（临时）：
   chrome --disable-web-security --user-data-dir=临时目录

3. 联系API提供商添加CORS支持

4. 使用浏览器扩展（如CORS Unblock）
            `;
            
            if (confirm('检测到CORS跨域错误，是否查看解决方案？')) {
                alert(helpMessage);
            }
        }
        
        // 复制到剪贴板
        async function copyToClipboard(auto = false) {
            const text = document.getElementById('resultText').value;
            if (!text) return;
            
            try {
                await navigator.clipboard.writeText(text);
                if (!auto) {
                    showToast('已复制到剪贴板！', 'success');
                }
                updateStatus('结果已复制到剪贴板', 'success');
            } catch (error) {
                console.error('复制失败:', error);
                // 降级方案
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (!auto) {
                    showToast('已复制到剪贴板！', 'success');
                }
                updateStatus('结果已复制到剪贴板', 'success');
            }
        }
        
        // 保存到历史记录
        function saveToHistory(sourceText, result, targetLanguage, context, apiResult) {
            const historyItem = {
                id: Date.now(),
                sourceText,
                result,
                targetLanguage,
                context,
                timestamp: new Date().toLocaleString(),
                elapsedTime: apiResult.elapsedTime,
                costPoints: apiResult.costPoints,
                user: apiConfig.username
            };
            
            translationHistory.unshift(historyItem);
            
            // 只保留最近50条记录
            if (translationHistory.length > 50) {
                translationHistory = translationHistory.slice(0, 50);
            }
            
            localStorage.setItem('translationHistory', JSON.stringify(translationHistory));
            loadHistory();
        }
        
        // 加载历史记录
        function loadHistory() {
            const historyList = document.getElementById('historyList');
            
            if (translationHistory.length === 0) {
                historyList.innerHTML = '<div style="text-align: center; color: #999; padding: 20px;">暂无翻译记录</div>';
                return;
            }
            
            historyList.innerHTML = translationHistory.map(item => `
                <div class="history-item" onclick="loadHistoryItem(${item.id})">
                    <div class="text">${item.sourceText.substring(0, 30)}${item.sourceText.length > 30 ? '...' : ''}</div>
                    <div class="meta">${item.targetLanguage} | ${item.timestamp}</div>
                </div>
            `).join('');
        }
        
        // 加载历史记录项
        function loadHistoryItem(id) {
            const item = translationHistory.find(h => h.id === id);
            if (item) {
                document.getElementById('targetLanguage').value = item.targetLanguage;
                document.getElementById('context').value = item.context;
                document.getElementById('sourceText').value = item.sourceText;
                document.getElementById('resultText').value = item.result;
                currentResult = item.result;
                document.getElementById('copyBtn').disabled = false;
                updateStatus(`已加载历史记录 | 耗时: ${item.elapsedTime}ms | 积分: ${item.costPoints}`, 'success');
            }
        }
        
        // 更新状态
        function updateStatus(message, type = 'normal') {
            const statusText = document.getElementById('statusText');
            statusText.textContent = message;
            statusText.className = `status-text ${type}`;
        }
        
        // 显示提示框
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'error' ? '#dc3545' : '#28a745';
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // 键盘快捷键
        document.addEventListener('keydown', function(e) {
            // Ctrl + Enter 翻译
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                translateText();
            }
            // Ctrl + C 复制
            else if (e.ctrlKey && e.key === 'c' && currentResult) {
                copyToClipboard();
            }
            // Ctrl + N 新翻译
            else if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                newTranslation();
            }
            // Escape 关闭模态框
            else if (e.key === 'Escape') {
                closeSettings();
            }
        });
    </script>
</body>
</html>
